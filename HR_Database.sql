use human_resource1;

CREATE TABLE countries (
COUNTRY_ID varchar(2) NOT NULL,
COUNTRY_NAME varchar(40) DEFAULT NULL,
REGION_ID decimal(10,0) DEFAULT NULL,
PRIMARY KEY (COUNTRY_ID),
KEY COUNTR_REG_FK (REGION_ID)
);

show tables;

INSERT INTO countries(COUNTRY_ID,COUNTRY_NAME,REGION_ID) VALUES
('CH' , 'CHINA' ,3),
('BE', 'BELGIUM' , 1),
('CA' , 'CANADA' ,2),
('FR', 'FRANCE', 3),
('DE' , 'GERMANY',1),
('IN' ,'INDIA', 4),
('JP' ,'JAPAN', 3),
('MY', 'MALAYSIA',2),
('ES' ,'SPAIN',1),
('SE','SWEDEN' ,4);

SELECT * FROM countries;

CREATE TABLE departments (
 DEPARTMENT_ID decimal(4,0) NOT NULL DEFAULT 0,
DEPARTMENT_NAME varchar(30) NOT NULL,
MANAGER_ID decimal(6,0) DEFAULT NULL,
LOCATION_ID  decimal(4,0) DEFAULT NULL,
PRIMARY KEY(DEPARTMENT_ID),
KEY  DEPT_MGR_FK (MANAGER_ID),
KEY DEPT_LOCATION_IX (LOCATION_ID)
);

INSERT INTO departments(DEPARTMENT_ID,DEPARTMENT_NAME,MANAGER_ID,LOCATION_ID) VALUES
(10, 'Administration',200, 1700),
(20, 'Marketing' , 201, 1800),
(30 ,'Human Resource' ,203,2400),
(40, 'Shipping' , 121,1500),
(50, 'IT' , 103,1400),
(60, 'Government Sales',0,1700);

SELECT * FROM departments;

CREATE TABLE IF NOT EXISTS employess (
EMPLOYEE_ID  decimal(6,0) NOT NULL DEFAULT 0,
FIRST_NAME varchar(20) NOT NULL,
LAST_NAME varchar(20)  NOT NULL,
EMAIL_ID varchar(25) NOT NULL,
PHONE_NUMBER bigInt(10) DEFAULT NULL,
HIRE_DATE date NOT NULL,
JOB_ID  varchar(20) NOT NULL,
SALARY decimal(8,2) DEFAULT NULL,
MANAGER_ID decimal(6,0) DEFAULT NULL,
DEPARTMENT_ID decimal(4,0),
PRIMARY KEY (EMPLOYEE_ID),
UNIQUE KEY EMP_EMAILID_UK(EMAIL_ID),
KEY EMP_DEPARTMENT_IX (DEPARTMENT_ID),
KEY EMP_JOB_IX (JOB_ID),
KEY EMP_MANAGER_IX (MANAGER_ID),
KEY EMP_NAME_IX(LAST_NAME, FIRST_NAME)
);

INSERT INTO employess(EMPLOYEE_ID,FIRST_NAME,LAST_NAME,EMAIL_ID,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,MANAGER_ID,DEPARTMENT_ID) VALUES
(100,'Steven', 'King' , 'sking@mail.com' ,9441207411, '1987-06-17' ,'AD_PRES',240000.00,10,90 ),
(101, 'Neena' ,'Kochhar','nkochhar@gmail.com' ,9423601012 ,'1987-06-18','AD_VD' ,17000.00 ,100,90),
(102, 'Lex' ,'De Haan' ,'ldehaan@gmail.com',9520215862, '1987-06-19','AD_VP' , 19000.00,100,90),
(103, 'Bruce' ,'Earnst' ,'bearnst@gmail.com' ,9820506098 , '1987-06-20' ,'IT_PROG',9000.00,102,60),
(104, 'Julia' ,'Nayer', 'jnayar@gmail.com' ,8320141510,'1987-06-21', 'ST_CLERK' ,3800.00,120, 150),
(105, 'Kevin' ,'Mourgos' ,'kmourgos@gmail.com',9527576065, '1987-06-22' , 'ST_MAN',3000.00,1100,50);

SELECT * FROM employess;
UPDATE  employeEs
SET SALARY=24000.00
WHERE EMPLOYEE_ID=100 ;
SELECT * FROM employees ;

CREATE TABLE IF NOT EXISTS job_history (
EMPLOYEE_ID decimal(6,0) NOT NULL,
START_DATE date NOT NULL,
END_DATE date NOT NULL,
JOB_ID varchar(10) NOT NULL,
DEPARTMENT_ID decimal(4,0) DEFAULT NULL,
PRIMARY KEY (EMPLOYEE_ID, START_DATE),
KEY JHIST_DEPARTMENT_IX (DEPARTMENT_ID),
KEY JHIST_EMPLOYEE_IX (EMPLOYEE_ID),
KEY JHIST_JOB_IX (JOB_ID)
);

INSERT INTO job_history(EMPLOYEE_ID, START_DATE ,END_DATE ,JOB_ID,DEPARTMENT_ID) VALUES
(102, '1993-01-13', '1998-07-24' ,'IT_PROG', 60),
(101,'1989-09-21','1993-10-27' ,'AC_ACCOUNT' ,110),
(101, '1993-10-20' ,'1997-03-15' ,'AC_MGR',110),
(201, '1996-02-17','1999-04-25' ,'ST_CLERK' ,150),
(205, '1998-01-01', '1999-12-31' ,'ST_CLERK',50),
(122, '1999-03-24' ,'1999-12-31' ,'AD_ASST', 90); 

SELECT * FROM job_history;

CREATE TABLE IF NOT EXISTS jobs (
JOB_ID  varchar(10) NOT NULL DEFAULT 0,
JOB_TITLE  varchar(35) NOT NULL,
MIN_SALARY decimal(6,0) DEFAULT NULL,
MAX_SALARY decimal(6,0) DEFAULT NULL,
PRIMARY KEY(JOB_ID)
);

INSERT INTO jobs (JOB_ID, JOB_TITLE, MIN_SALARY,MAX_SALARY) VALUES
('AD_PRES' ,'PRESIDENT',20000, 40000),
('FI_MGR' ,'FINANCE MANAGER',8200,16000),
('FI_ACCOUNT' ,'ACCOUNTANT',4200 ,9000),
('SA_MAN' , 'SALES MANAGER',10000,20000),
('ST_MAN', 'STOCK MANAGER',5500 ,8500),
('ST_CLERK' ,'STOCK CLERK' ,2000,5000),
('IT_PROG', 'PROGRAMMER',4000,10000);

SELECT * FROM jobs;

CREATE TABLE LOCATION (
LOCATION_ID decimal(4,0) NOT NULL DEFAULT 0,
STREET_ADDRESS  varchar(40) DEFAULT NULL,
POSTAL_CODE  varchar(12) DEFAULT NULL,
CITY varchar(30) NOT NULL ,
STATE_PROVINCE  varchar(25) DEFAULT NULL,
COUNTRY_ID varchar(2) DEFAULT NULL,
PRIMARY KEY(LOCATION_ID),
KEY  LOC_CITY_IX (CITY),
KEY LOC_COUNTRY_IX (COUNTRY_ID),
KEY LOC_STATE_PROVINCE_IX (STATE_PROVINCE)
);

INSERT INTO LOCATION (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID) VALUES
(1000, '1297 via cold di Rie',989, 'Roma', 'Venice','IT'),
(1100, '9450 Kamiya Cho' ,6823,'Hiroshima','Honshu' ,'JP'),
(1200 ,'2007 Zagora St ' ,'50090 ' ,'South Braunswick' , 'New Jersery','US'),
(1300 , '2004 Carade road',  98199, 'Seattle', 'Washington', 'US'),
(1400 , '1298 Vileparle',  490231,'Bombay', 'Maharashtra' ,'IN'),
(1500 , '198 Clementi North', 540198, 'Yishun' ,'Singapore' , 'SG');

SELECT * FROM LOCATION ;

CREATE TABLE regions (
REGION_ID decimal(5,0) NOT NULL,
REGION_NAME varchar(25) DEFAULT NULL,
PRIMARY KEY (REGION_ID),
UNIQUE KEY sss (REGION_NAME)
);

INSERT INTO regions (REGION_ID , REGION_NAME) VALUES
(1, 'Europe\r'),
(2,'America\r'),
(3, 'Asia\r'),
(4, 'Middle East and Africa\r');

SELECT * FROM regions;
SHOW TABLES;

SELECT FIRST_NAME first_name ,LAST_NAME last_name from employess;

SELECT DISTINCT (DEPARTMENT_ID) FROM employess;

ALTER TABLE employess RENAME TO employees ;
SHOW TABLES;
SELECT * FROM employees
 order by FIRST_NAME  DESC;
 
 SELECT AVG(SALARY) ,COUNT(EMPLOYEE_ID) FROM employees ;
 
 SELECT Max(SALARY) AS "Max Salary", Min(SALARY) AS "Min Salary" FROM employees;
 
 SELECT SUM(SALARY) FROM employees;
 
 SELECT COUNT(EMPLOYEE_ID) 
 FROM employees
 WHERE EMPLOYEE_ID != 0;
 
 SELECT FIRST_NAME, LAST_NAME ,SALARY 
 FROM employees
 ORDER BY SALARY ASC ;
 
 SELECT FIRST_NAME, LAST_NAME , SALARY, (15/100)*SALARY PF
 FROM employees ;
 
 SELECT COUNT(distinct(JOB_ID))
 FROM employees ;

SELECT UPPER(FIRST_NAME) FROM employees ;

SELECT SUBSTRING(FIRST_NAME,1,3) FROM employees ;

SELECT 171*214+625 FROM DUAL ;

SELECT concat(FIRST_NAME,'  ',LAST_NAME) Full_Name FROM employees ;

SELECT FIRST_NAME, LAST_NAME, LENGTH(FIRST_NAME)+LENGTH(LAST_NAME) TOTAL_LENGTH FROM employees ;

SELECT EMPLOYEE_ID ,FIRST_NAME
FROM employees LIMIT 5 ;

SELECT FIRST_NAME ,LAST_NAME, ROUND(SALARY/12,2) AS 'Monthly Salary'
FROM employees ;

SELECT FIRST_NAME ,LAST_NAME, SALARY
FROM employees
WHERE SALARY NOT IN (10000,15000) ;

SELECT FIRST_NAME, LAST_NAME, DEPARTMENT_ID
FROM employees
WHERE DEPARTMENT_ID IN (30 or 100)
ORDER BY DEPARTMENT_ID ASC ;

SELECT FIRST_NAME ,LAST_NAME , HIRE_DATE
FROM employees
WHERE HIRE_DATE LIKE '%1987%' ;

SELECT FIRST_NAME
FROM employees
WHERE FIRST_NAME LIKE '%b%'and FIRST_NAME LIKE '%c%' ;

SELECT  LAST_NAME, JOB_ID, SALARY
FROM employees
WHERE  JOB_ID IN ('IT_PROG' ,'ST_CLERK')
AND SALARY NOT IN (4500, 10000,15000) ;

SELECT LAST_NAME 
FROM employees
WHERE LAST_NAME LIKE '______' ;

WHERE  LENGTH(LAST_NAME)=6 ; 

SELECT LAST_NAME FROM employees 
WHERE LAST_NAME LIKE '__e%' ;

SELECT * FROM employees
WHERE LAST_NAME IN ('BLAKE' , 'SCOTT' ,'KING' ,'FORD' ) ;